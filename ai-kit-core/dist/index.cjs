"use strict";var $=Object.defineProperty;var je=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var Ge=Object.prototype.hasOwnProperty;var P=(e,t)=>()=>(e&&(t=e(e=0)),t);var H=(e,t)=>{for(var r in t)$(e,r,{get:t[r],enumerable:!0})},$e=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Ve(t))!Ge.call(e,a)&&a!==r&&$(e,a,{get:()=>t[a],enumerable:!(n=je(t,a))||n.enumerable});return e};var Xe=e=>$e($({},"__esModule",{value:!0}),e);function T(){return globalThis.WpSuite?.plugins?.aiKit}async function X(e=8e3){let t=T();if(t?.status!=="available"){if(t?.status==="error")throw new Error("AiKit failed");await new Promise((r,n)=>{let a=()=>s(r),o=()=>s(()=>n(new Error("AiKit failed"))),s=u=>{window.removeEventListener("wpsuite:ai-kit:ready",a),window.removeEventListener("wpsuite:ai-kit:error",o),i&&clearTimeout(i),u()};window.addEventListener("wpsuite:ai-kit:ready",a,{once:!0}),window.addEventListener("wpsuite:ai-kit:error",o,{once:!0});let i=e?window.setTimeout(()=>s(()=>n(new Error("AiKit timeout"))),e):0})}}async function ce(e=1e4){await X(e);let r=T()?.features?.store;if(!r)throw new Error("AiKit store is not available");return r}var J=P(()=>{"use strict"});var le,A,Q,Z,Y,Je,Qe,Ze,Ye,et,de,U,ge,pe,q=P(()=>{"use strict";le=require("@smart-cloud/wpsuite-core"),A=require("@wordpress/data"),Q=require("aws-amplify/utils");J();typeof WpSuite<"u"?Z=WpSuite.siteSettings:Z={};Y=e=>{let t=e&&typeof e=="object"?e:{},r={};return typeof t.mode=="string"&&(r.mode=t.mode),typeof t.backendTransport=="string"&&(r.backendTransport=t.backendTransport),typeof t.backendApiName=="string"&&(r.backendApiName=t.backendApiName),typeof t.backendBaseUrl=="string"&&(r.backendBaseUrl=t.backendBaseUrl),typeof t.subscriptionType=="string"&&(r.subscriptionType=t.subscriptionType),typeof t.enableChatbot=="boolean"&&(r.enableChatbot=t.enableChatbot),typeof t.chatbot=="object"&&t.chatbot!==null&&(r.chatbot=t.chatbot),r},Je=async()=>{let e=T();if(!e)throw new Error("AI-Kit plugin is not available");let t=null;return e.settings.customTranslationsUrl&&(t=await fetch(e.settings.customTranslationsUrl+(e.settings.customTranslationsUrl.includes("?")?"&":"?")+"t="+Z.lastUpdate).then(r=>r.ok?r.text():null).then(r=>r?JSON.parse(r):null).catch(()=>null)),t??null},Qe=async()=>{let e=Y(await(0,le.getConfig)("aiKit")),t=await Je();return{config:e,showChatbotPreview:!1,language:void 0,direction:void 0,customTranslations:t}},Ze={setShowChatbotPreview(e){return{type:"SET_SHOW_CHATBOT_PREVIEW",showChatbotPreview:e}},setLanguage(e){return!e||e==="system"?Q.I18n.setLanguage(""):Q.I18n.setLanguage(e),{type:"SET_LANGUAGE",language:e}},setDirection(e){return{type:"SET_DIRECTION",direction:e}}},Ye={getConfig(e){return e.config},isShowChatbotPreview(e){return e.showChatbotPreview},getCustomTranslations(e){return e.customTranslations},getLanguage(e){return e.language},getDirection(e){return e.direction},getState(e){return e}},et={},de=e=>(0,A.dispatch)(e),U=e=>(0,A.select)(e),ge=async()=>{let e=await Qe(),t=(0,A.createReduxStore)("wpsuite/ai-kit",{reducer(r=e,n){switch(n.type){case"SET_LANGUAGE":return{...r,language:n.language};case"SET_DIRECTION":return{...r,direction:n.direction};case"SET_SHOW_CHATBOT_PREVIEW":return{...r,showChatbotPreview:n.showChatbotPreview}}return r},actions:Ze,selectors:Ye,resolvers:et});return(0,A.register)(t),t},pe=(e,t,r)=>{let n;function a(){let s=U(e).getState(),i=t(s);if(i!==n){let u=n;n=i,r(n,u)}}let o=(0,A.subscribe)(a,e);return a(),o}});var y,me=P(()=>{"use strict";y="smartcloud-ai-kit"});var h,tt,rt,nt,fe=P(()=>{"use strict";h=require("react/jsx-runtime"),tt=e=>(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"48",height:"48",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,h.jsx)("path",{d:"M19 27H33"}),(0,h.jsx)("path",{d:"M19 33H33"}),(0,h.jsx)("path",{d:"M8 21L9.5 24L12.5 25.5L9.5 27L8 30L6.5 27L3.5 25.5L6.5 24Z"}),(0,h.jsx)("path",{d:"M36 4L38 8L42 10L38 12L36 16L34 12L30 10L34 8Z"}),(0,h.jsx)("path",{d:"M16 10V40H36V22"}),(0,h.jsx)("path",{d:"M16 10H22"}),(0,h.jsx)("path",{d:"M22 10V23H36"}),(0,h.jsx)("path",{d:"M22 10L36 22"})]}),rt=e=>(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"48",height:"48",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,h.jsx)("path",{d:"M42 38L34 30H10C7.79086 30 6 28.2091 6 26V8C6 5.79086 7.79086 4 10 4H38C40.2091 4 42 5.79086 42 8V38Z"}),(0,h.jsx)("rect",{x:"14",y:"13",width:"6",height:"6",rx:"1"}),(0,h.jsx)("rect",{x:"28",y:"13",width:"6",height:"6",rx:"1"}),(0,h.jsx)("path",{d:"M16 24H32"})]}),nt=e=>(0,h.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,h.jsx)("path",{stroke:"none",d:"M0 0h48v48H0z",fill:"none"}),(0,h.jsx)("path",{d:"M6 20a14 14 0 1 0 28 0a14 14 0 1 0 -28 0"}),(0,h.jsx)("path",{d:"M42 42l-12 -12"}),(0,h.jsx)("path",{d:"M20 20a3 3 0 1 0 -2.28 -4.948"}),(0,h.jsx)("circle",{cx:"20",cy:"26",r:"0.9",fill:"currentColor",stroke:"none"})]})});var x,ee=P(()=>{"use strict";x=class extends Error{constructor(r,n,a){super(r);this.decision=n;this.status=a;this.name="AiBackendError"}}});var Ce={};H(Ce,{MIN_CHROME_VERSION:()=>he,checkOnDeviceAvailability:()=>ke,decideCapability:()=>V,resolveBackend:()=>K});async function ye(){let t=await at?.plugins?.aiKit?.features.store;return U(t).getConfig()??{}}function we(e){let t=e.backendApiName?.trim()||void 0,r=e.backendBaseUrl?.trim()||void 0;return{transport:e.backendTransport??(r?"fetch":t?"gatey":void 0),backendApiName:t,backendBaseUrl:r}}function ot(e){if(e.mode)return e.mode;let{transport:t}=we(e);return t?"backend-fallback":"local-only"}async function K(){let e=await ye(),{transport:t,backendApiName:r,backendBaseUrl:n}=we(e);if(!t)return{available:!1,reason:"No backend configured"};if(t==="fetch")return n?{available:!0,transport:t,baseUrl:n,reason:"Custom fetch backend"}:{available:!1,reason:"backendBaseUrl is missing"};if(!r)return{available:!1,reason:"backendApiName is missing"};let a=globalThis.WpSuite?.plugins?.gatey;return!a?.availability||await a.availability()!=="available"?{available:!1,reason:"Gatey is not available"}:{available:!0,transport:t,apiName:r,reason:"Gatey backend"}}function O(e){return typeof globalThis[e]<"u"}function ve(e){if(!e)return;let t=Number.parseInt(String(e).split(".")[0]??"",10);return Number.isFinite(t)?t:void 0}function j(e,t){return e?.find(r=>r.brand===t)?.version}async function st(){let e=navigator?.userAgentData;if(e){try{let r=(await e.getHighEntropyValues?.(["fullVersionList"]))?.fullVersionList;if(Array.isArray(r)&&r.length>0)return r}catch{}if(Array.isArray(e.brands)&&e.brands.length>0)return e.brands}}function it(e){let t=e.match(/\b(?:Chrome|Chromium)\/(\d{2,3})\b/i);return t?.[1]?ve(t[1]):void 0}function ut(){return!!navigator?.brave}async function ct(e){if(typeof navigator>"u")return{allowed:!1,reason:"no-navigator"};if(typeof globalThis.isSecureContext=="boolean"&&!globalThis.isSecureContext)return{allowed:!1,reason:"not-secure-context"};let t=navigator.userAgent??"",r=await st(),n=j(r,"Microsoft Edge")??j(r,"Microsoft Edge WebView2"),a=j(r,"Google Chrome")??j(r,"Chromium"),o=!!n||/\bEdg\//i.test(t)||/\bEdgiOS\//i.test(t),s=/\bOPR\//i.test(t),i=/\bVivaldi\//i.test(t),u=/\bSamsungBrowser\//i.test(t),c=/\bFirefox\//i.test(t),g=!/\bChrome\//i.test(t)&&/\bSafari\//i.test(t)&&!/\bChromium\//i.test(t),l=ut()||/\bBrave\//i.test(t);if(o||s||i||u||c||g||l)return{allowed:!1,reason:o?"edge":l?"brave":c?"firefox":g?"safari":s?"opera":i?"vivaldi":u?"samsung":"unsupported-browser"};let p=ve(a)??it(t),f=he[e];return f?p?p<f?{allowed:!1,reason:`chrome-too-old-${p}-lt-${f}`,chromeMajor:p}:{allowed:!0,reason:"ok",chromeMajor:p}:{allowed:!1,reason:"unknown-chrome-version"}:{allowed:!1,reason:"no-min-version",chromeMajor:p}}async function ke(e,t){try{let r=await ct(e),n=`browser-gate:${r.reason}${r.chromeMajor?` (chrome ${r.chromeMajor})`:""}`;if(!r.allowed)return{available:!1,status:"unavailable",reason:n};switch(e){case"writer":{if(!O("Writer")||!Writer?.availability)return{available:!1,status:"api-not-present",reason:n};let a=await Writer.availability(t);return{available:a!=="unavailable",status:a,reason:n}}case"rewriter":{if(!O("Rewriter")||!Rewriter?.availability)return{available:!1,status:"api-not-present",reason:n};let a=await Rewriter.availability(t);return{available:a!=="unavailable",status:a,reason:n}}case"summarizer":{if(!O("Summarizer")||!Summarizer?.availability)return{available:!1,status:"api-not-present",reason:n};let a=await Summarizer.availability(t);return{available:a!=="unavailable",status:a,reason:n}}case"proofreader":{if(!O("Proofreader")||!Proofreader?.availability)return{available:!1,status:"api-not-present",reason:n};let a=await Proofreader.availability(t);return{available:a!=="unavailable",status:a,reason:n}}case"language-detector":{if(!O("LanguageDetector")||!LanguageDetector?.availability)return{available:!1,status:"api-not-present",reason:n};let a=await LanguageDetector.availability(t);return{available:a!=="unavailable",status:a,reason:n}}case"translator":{if(!O("Translator")||!Translator?.availability)return{available:!1,status:"api-not-present",reason:n};let a=t;if(!a?.sourceLanguage||!a?.targetLanguage)return{available:!1,status:"error",reason:n,error:new Error("Translator.availability requires sourceLanguage/targetLanguage")};let o=await Translator.availability({...a,sourceLanguage:a.sourceLanguage==="auto"?"en":a.sourceLanguage,targetLanguage:a.sourceLanguage==="auto"||a.sourceLanguage===a.targetLanguage?"hu":a.targetLanguage});return{available:o!=="unavailable",status:o,reason:n}}case"prompt":{if(!O("LanguageModel")||!LanguageModel?.availability)return{available:!1,status:"api-not-present",reason:n};let a=await LanguageModel.availability(t);return{available:a!=="unavailable",status:a,reason:n}}default:return{available:!1,status:"unknown-feature",reason:n}}}catch(r){return{available:!1,status:"error",reason:"exception in availability()",error:r}}}async function V(e,t,r){let n=await ye(),a=r||ot(n),o=await K(),s=await ke(e,t),i=s.available,u=o.available,c={feature:e,mode:a,onDeviceAvailable:i,onDeviceStatus:s.status,onDeviceReason:s.reason,backendAvailable:u,backendTransport:o.transport,backendApiName:o.apiName,backendBaseUrl:o.baseUrl,backendReason:o.reason};return a==="local-only"?i?{...c,source:"on-device",reason:`local-only: on-device available (${s.reason??s.status})`}:{...c,source:"none",reason:`local-only: on-device unavailable (${s.reason??s.status})`}:a==="backend-only"?u?{...c,source:"backend",reason:`backend-only: backend available (${o.reason??"n/a"})`}:{...c,source:"none",reason:`backend-only: backend unavailable (${o.reason??"n/a"})`}:i?{...c,source:"on-device",reason:`backend-fallback: using on-device (${s.reason??s.status})`}:u?{...c,source:"backend",reason:`backend-fallback: using backend (${o.reason??"n/a"}; on-device: ${s.reason??s.status})`}:{...c,source:"none",reason:`No on-device AI or backend available (on-device: ${s.reason??s.status}; backend: ${o.reason??"n/a"})`}}var be,at,he,te=P(()=>{"use strict";be=require("@smart-cloud/wpsuite-core");q();at=(0,be.getWpSuite)();he={summarizer:138,translator:138,"language-detector":138,writer:137,rewriter:137,proofreader:141,prompt:138}});var Te={};H(Te,{dispatchBackend:()=>I,withRecaptchaHeaders:()=>z});function lt(){return globalThis.WpSuite?.plugins?.aiKit?.settings??{}}function dt(e){if(!e)return;let t=Date.parse(e);return Number.isFinite(t)?t:void 0}function gt(e){let t=e?.reCaptchaChatTtlSeconds,r=typeof t=="number"&&Number.isFinite(t)?Math.max(0,t):120;return Math.min(3600,r)*1e3}function pt(e,t){let r=gt(t);if(r<=0)return!1;let n=Pe.get(e);return n?Date.now()-n<r:!1}function re(e,t){let r=dt(t);r&&Pe.set(e,r)}function xe(e,t,r){if(e!=="frontend"||t!=="prompt"||!Le(r)||r.saveChatSession!==!0)return;let n=r.sessionId;return typeof n=="string"&&n.trim()?n.trim():void 0}function Se(e,t){if(!e)return;try{if(typeof e.get=="function")return e.get(t)??void 0}catch{}let r=Object.keys(e).find(a=>a.toLowerCase()===t.toLowerCase());if(!r)return;let n=e[r];return typeof n=="string"&&n?n:void 0}async function mt(e,t){if(e!=="frontend")return;let r=lt();if(!r?.reCaptchaSiteKey||t?.cacheKey&&pt(t.cacheKey,r))return;let{execute:n}=await(0,Ae.getRecaptcha)(r?.useRecaptchaEnterprise||!1);if(typeof n=="function")try{let o=await n(r.reCaptchaSiteKey,{action:"generate"});return typeof o=="string"&&o?o:void 0}catch{return}}async function z(e,t,r){if(e!=="frontend"||t["X-Recaptcha-Token"]||t["x-recaptcha-token"])return t;let n=await mt(e,r);return n?{...t,"X-Recaptcha-Token":n}:t}function E(e,t){try{e?.onStatus?.(t)}catch{}}function Le(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function bt(e,t){if(!Le(t))return t;let r=ft[e];if(!r)return t;let n={};for(let a of r)a in t&&(n[a]=t[a]);return n}function ht(e,t){return(e==="admin"?yt:wt)[t]}async function I(e,t,r,n,a={}){let o=ht(t,r),s=bt(r,n);if(!o)throw new x(`No backend path configured for "${r}" (${t}).`,e);if(e.backendTransport==="fetch"){if(!e.backendBaseUrl)throw new x("backendTransport=fetch but backendBaseUrl is missing.",e);return vt(e.backendBaseUrl,o,s,a,e,r,t)}if(!e.backendApiName)throw new x("backendTransport=gatey but backendApiName is missing.",e);return kt(e.backendApiName,o,s,a,e,r,t)}async function vt(e,t,r,n,a,o,s){let i=`${e.replace(/\/+$/,"")}${t}`,u={"content-type":"application/json",...n.headers??{}},c=xe(s,o,r),g=await z(s,u,{cacheKey:c}),l=n.query&&Object.keys(n.query).length>0?"?"+new URLSearchParams(Object.entries(n.query).map(([m,k])=>[m,String(k)])).toString():"";E(n,{feature:o,context:s,step:"backend:request",source:"backend"}),E(n,{feature:o,context:s,step:"backend:waiting",source:"backend"});let p=await fetch(i+l,{method:"POST",headers:g,body:JSON.stringify(r??{}),signal:n.signal,credentials:"omit"});if(E(n,{feature:o,context:s,step:"backend:response",source:"backend"}),!p.ok){let m=`HTTP ${p.status}`;try{let k=await p.text();k&&(m=`${m}: ${k.substring(0,400)}`)}catch{}throw new x(`Fetch backend call failed: ${m}`,a,p.status)}let f=p.headers.get("content-type")||"",v=Se(p.headers,"x-recaptcha-verified-at");if(f.includes("application/json")){let m=await p.json(),k=(m&&typeof m.sessionId=="string"&&m.sessionId.trim()?m.sessionId.trim():void 0)??c;return v&&k&&re(k,v),m}return v&&c&&re(c,v),await p.text()}async function kt(e,t,r,n,a,o,s){let u=globalThis.WpSuite?.plugins?.gatey;if(!u?.cognito?.post)throw new x("Gatey backend selected, but Gatey.cognito.post is not available.",a);let c=xe(s,o,r),g=await z(s,{...n.headers??{}},{cacheKey:c});E(n,{feature:o,context:s,step:"backend:request",source:"backend"}),E(n,{feature:o,context:s,step:"backend:waiting",source:"backend"});let l=u.cognito.post({apiName:e,path:t,options:{body:r,headers:g,retryStrategy:{strategy:"no-retry"}}});n?.signal?.addEventListener?.("abort",()=>{l.cancel()});let p=await l.response,f=Se(p.headers,"x-recaptcha-verified-at"),v=await p.body.json(),m=v?.sessionId??c;return f&&typeof m=="string"&&m.trim()&&re(m.trim(),f),E(n,{feature:o,context:s,step:"backend:response",source:"backend"}),v}var Ae,Pe,ft,yt,wt,ne=P(()=>{"use strict";Ae=require("@smart-cloud/wpsuite-core");ee();Pe=new Map;ft={prompt:["text","systemPrompt","context","responseConstraint","saveChatSession","engine","sessionId","images","imageUrls","feedbackMessageId","feedbackType","knowledgeBaseId","disableKB","enableRerank","topK","temperature"],writer:["text","outputLanguage","instruction","context","tone","format","length","knowledgeBaseId","disableKB"],rewriter:["text","outputLanguage","instruction","context","tone","format","length"],summarizer:["text","outputLanguage","instruction","context","type","format","length"],translator:["text","sourceLanguage","targetLanguage"],"language-detector":["text","maxCandidates"],proofreader:["text","expectedInputLanguages"]};yt={prompt:"/admin/prompt",writer:"/admin/write",rewriter:"/admin/rewrite",summarizer:"/admin/summarize",translator:"/admin/translate","language-detector":"/admin/detect-language",proofreader:"/admin/proofread"},wt={prompt:"/frontend/prompt",writer:"/frontend/write",rewriter:"/frontend/rewrite",summarizer:"/frontend/summarize",translator:"/frontend/translate","language-detector":"/frontend/detect-language",proofreader:"/frontend/proofread"}});var Ne={};H(Ne,{detectLanguage:()=>zt,getPromptOptions:()=>We,getProofreadOptions:()=>Fe,getRewriteOptions:()=>Ie,getSummarizeOptions:()=>De,getTranslateOptions:()=>Ue,getWriteOptions:()=>Ee,prompt:()=>Xt,proofread:()=>Dt,rewrite:()=>Ft,sendChatMessage:()=>Jt,sendFeedbackMessage:()=>Zt,sendSearchMessage:()=>Qt,summarize:()=>Ut,translate:()=>_,write:()=>It});function oe(e){if(e==null)return String(e);if(typeof e!="object")return JSON.stringify(e);if(Array.isArray(e))return"["+e.map(oe).join(",")+"]";let t=e;return"{"+Object.keys(t).sort().map(n=>JSON.stringify(n)+":"+oe(t[n])).join(",")+"}"}function Ct(e){let t=5381;for(let r=0;r<e.length;r++)t=t*33^e.charCodeAt(r);return(t>>>0).toString(36)}function At(e,t){return`${e}:${Ct(oe(t))}`}function ae(){let e=new Map;for(let r of C.values()){let n=e.get(r.kind)??[];n.push(r),e.set(r.kind,n)}for(let[r,n]of e.entries())if(!(n.length<=Re)){n.sort((a,o)=>a.refCount-o.refCount||a.lastUsed-o.lastUsed||a.key.localeCompare(o.key));for(let a of n){if(e.get(r).length<=Re)break;if(!(a.refCount>0)){try{a.destroy()}catch{}C.delete(a.key),e.set(r,(e.get(r)??[]).filter(o=>o.key!==a.key))}}}if(C.size<=Oe)return;let t=Array.from(C.values());t.sort((r,n)=>r.refCount-n.refCount||r.lastUsed-n.lastUsed||r.key.localeCompare(n.key));for(let r of t){if(C.size<=Oe)break;if(!(r.refCount>0)){try{r.destroy()}catch{}C.delete(r.key)}}}async function R(e,t,r,n){let a=At(e,t),o=C.get(a);if(o)return o.refCount++,o.lastUsed=Date.now(),C.delete(a),C.set(a,o),{model:o.model,fromCache:!0,release:()=>{let u=C.get(a);u&&(u.refCount=Math.max(0,u.refCount-1),u.lastUsed=Date.now(),ae())}};let s=W.get(a);if(s)return s;let i=(async()=>{let u=await r(),c={kind:e,key:a,model:u,refCount:1,lastUsed:Date.now(),destroy:()=>n(u)};return C.set(a,c),W.delete(a),ae(),{model:u,fromCache:!1,release:()=>{let g=C.get(a);g&&(g.refCount=Math.max(0,g.refCount-1),g.lastUsed=Date.now(),ae())}}})().catch(u=>{throw W.delete(a),u});return W.set(a,i),i}function S(){return(Me?.plugins?.aiKit?.settings??{}).defaultOutputLanguage??"en"}function N(e){let t=["en","ja","es"],r=e.toLowerCase();return t.some(n=>r===n.toLowerCase())}function d(e,t,r,n){try{r?.onStatus?.({feature:e,context:t,...n})}catch{}}function F(){return Me?.plugins?.aiKit?.settings?.sharedContext??void 0}function L(e){return e?.context??"admin"}function B(e,t=Pt){let r=new AbortController,n=e?.signal,a=typeof e?.onDeviceTimeoutOverride=="number"?e.onDeviceTimeoutOverride:void 0,o=typeof a=="number"?a:t,s,i=!1,u=()=>{if(r.signal.aborted)return;let c=typeof n?.reason<"u"?n?.reason:void 0;r.abort(c??new DOMException("Aborted","AbortError"))};return n&&(n.aborted?u():n.addEventListener("abort",u)),o&&o>0&&(s=setTimeout(()=>{r.signal.aborted||(i=!0,r.abort(new se(o)))},o)),{signal:r.signal,timedOut:()=>i,dispose:()=>{s&&(clearTimeout(s),s=void 0),n&&n.removeEventListener("abort",u)}}}function G(e){let t=e;return{knowledgeBaseId:typeof t.knowledgeBaseId=="string"?t.knowledgeBaseId:void 0,disableKB:typeof t.disableKB=="boolean"?t.disableKB:void 0}}async function xt(e,t,r,n){let a=G(e),o=await ze(e.images,r,t,n);return{text:e.messages.filter(s=>s.role==="user").map(s=>s.content).join(`
`),systemPrompt:e.messages.filter(s=>s.role==="system").map(s=>s.content).join(`
`),images:o?.images,imageUrls:o?.imageUrls,context:e.sharedContext,saveChatSession:!1,responseConstraint:e.responseConstraint,...a}}async function St(e,t,r){let n=G(e),a=await ze(e.images,t,"frontend",r);return{sessionId:e.sessionId,text:e.message,images:a?.images,imageUrls:a?.imageUrls,context:e.sessionId?void 0:e.sharedContext,saveChatSession:!0,...n}}async function Lt(e){let t=G(e);return{engine:"kb_rag",sessionId:e.sessionId,text:e.query,topK:e.topK,context:e.sessionId?void 0:e.sharedContext,saveChatSession:!1,...t}}async function Tt(e){return{sessionId:e.sessionId,feedbackMessageId:e.feedbackMessageId,feedbackType:e.feedbackType,saveChatSession:!0}}function Ot(e){let t=G(e);return{text:e.prompt,outputLanguage:e.outputLanguage,instruction:e.context?.trim()?e.context.trim():void 0,context:e.sharedContext,tone:e.tone,format:e.format,length:e.length,...t}}function Rt(e){return{text:e.text,outputLanguage:e.outputLanguage,instruction:e.context?.trim()?e.context.trim():void 0,context:e.sharedContext,tone:e.tone,format:e.format,length:e.length}}function Bt(e){return{text:e.text,outputLanguage:e.outputLanguage,instruction:e.context?.trim()?e.context.trim():void 0,context:e.sharedContext,type:e.type,format:e.format,length:e.length}}function Mt(e,t,r){return{text:e,sourceLanguage:t,targetLanguage:r}}function Kt(e,t){let r=t;return{text:e,maxCandidates:typeof r?.maxCandidates=="number"?r.maxCandidates:void 0}}function Et(e){return{text:e.text,expectedInputLanguages:e.expectedInputLanguages}}async function M(e,t,r,n,a,o,s,i){d(n,e,i,{step:"decide",message:"Deciding capability",silent:r});let u=await V(n,a,t);if(d(n,e,i,{step:"decide",source:u.source,message:`Using ${u.source}`,silent:r}),u.source==="on-device")try{let c=await o();return d(n,e,i,{step:"done",source:"on-device",silent:r}),c}catch(c){console.error(`Error in on-device ${n}:`,c),d(n,e,i,{step:"error",source:"on-device",message:c.message,silent:r}),i?.signal?.throwIfAborted()}if(u.mode!=="local-only"&&u.backendAvailable){d(n,e,i,{step:"backend:request",source:"backend",silent:r});let c=typeof s=="function"?await s(u):s,g=await I(u,e,n,c,i);return d(n,e,i,{step:"done",source:"backend",silent:r}),g}throw new Error(`No capability for "${n}" (${e}). Reason: ${u.reason}`)}function Wt(e){let t=Array.isArray(e.images)&&e.images.length>0,r=e.images??[],n=t?r.map(o=>({type:"image",value:o})):[],a;if(typeof e.messages=="string")a=t?[{role:"user",content:[{type:"text",value:e.messages},...n]}]:e.messages;else{let o=e.messages.filter(s=>s.role!=="system").map(s=>({role:s.role==="assistant"?"assistant":"user",content:s.content}));if(t){let s=-1;for(let i=o.length-1;i>=0;i--)if(o[i].role==="user"){s=i;break}if(s===-1)o.push({role:"user",content:[{type:"text",value:""},...n]});else{let i=String(o[s].content??"");o[s]={...o[s],content:[{type:"text",value:i},...n]}}}a=o}return a}function _t(e){return typeof Blob<"u"&&e instanceof Blob}function Ht(e){let t=(e??"").toLowerCase();return t.includes("png")?"png":t.includes("webp")?"webp":t.includes("gif")?"gif":t.includes("bmp")?"bmp":"jpg"}function qt(e){let t=(e??"").toLowerCase();return t.includes("png")?"png":t.includes("webp")?"webp":t.includes("gif")?"gif":"jpeg"}async function jt(e){return new Promise((t,r)=>{let n=new FileReader;n.onerror=()=>r(n.error??new Error("FileReader error")),n.onload=()=>t(String(n.result??"")),n.readAsDataURL(e)})}async function Vt(e){let t=await jt(e),r=t.indexOf(",");return r>=0?t.substring(r+1):t}async function Gt(e,t,r,n,a,o){let s=t==="admin"?"/admin/generate-upload-url":"/frontend/generate-upload-url",i={...o?.headers??{}},u=await z(t,i);if(e.backendTransport==="fetch"){if(!e.backendBaseUrl)throw new Error("backendBaseUrl missing for fetch transport");let f=new URLSearchParams({fileName:r,contentType:n,contentLength:String(a)}).toString(),v=`${e.backendBaseUrl.replace(/\/+$/,"")}${s}?${f}`,m=await fetch(v,{method:"GET",headers:u,signal:o?.signal,credentials:"omit"});if(!m.ok){let D=await m.text().catch(()=>"");throw new Error(`generate-upload-url failed (fetch): HTTP ${m.status}${D?": "+D.substring(0,200):""}`)}let k=await m.json();if(!k?.uploadUrl||!k?.imageKey)throw new Error("generate-upload-url response missing uploadUrl/imageKey");return{uploadUrl:k.uploadUrl,imageKey:k.imageKey}}if(!e.backendApiName)throw new Error("backendApiName missing for gatey transport");let c=globalThis.WpSuite?.plugins?.gatey,g={fileName:r,contentType:n,contentLength:a};if(c?.cognito?.get){let f=c.cognito.get({apiName:e.backendApiName,path:s,options:{queryParams:Object.keys(g).reduce((m,k)=>(m[k]=String(g[k]),m),{}),headers:u,retryStrategy:{strategy:"no-retry"}}});o?.signal?.addEventListener?.("abort",()=>{f.cancel()});let v=await f.response.then(m=>m.body.json());if(!v?.uploadUrl||!v?.imageKey)throw new Error("generate-upload-url (gatey get) response missing uploadUrl/imageKey");return{uploadUrl:v.uploadUrl,imageKey:v.imageKey}}if(!c?.cognito?.post)throw new Error("Gatey.cognito.post is not available");let l=c.cognito.post({apiName:e.backendApiName,path:s,options:{body:g,headers:u,retryStrategy:{strategy:"no-retry"}}});o?.signal?.addEventListener?.("abort",()=>{l.cancel()});let p=await l.response.then(f=>f.body.json());if(!p?.uploadUrl||!p?.imageKey)throw new Error("generate-upload-url (gatey post) response missing uploadUrl/imageKey");return{uploadUrl:p.uploadUrl,imageKey:p.imageKey}}async function $t(e,t,r,n){let a=await fetch(e,{method:"PUT",headers:{"Content-Type":r||"application/octet-stream"},body:t,signal:n?.signal});if(!a.ok){let o=await a.text().catch(()=>"");throw new Error(`S3 upload failed: HTTP ${a.status}${o?": "+o.substring(0,200):""}`)}}async function ze(e,t,r,n){if(!e||e.length===0)return;let a=[];for(let c of e){if(!_t(c))throw new Error("Backend multimodal prompting currently supports only Blob/File inputs for images.");a.push(c)}let o=a.reduce((c,g)=>c+(g.size||0),0);if(Math.ceil(o*1.37+2048*a.length)<=Nt){d("prompt",r,n,{step:"backend:request",source:"backend",message:"Inlining images as base64"});let c=[];for(let g of a)c.push({format:qt(g.type),data:await Vt(g)});return{images:c}}d("prompt",r,n,{step:"backend:request",source:"backend",message:"Uploading images via signed URL"});let u=[];for(let c=0;c<a.length;c++){let g=a[c],l=g.type||"application/octet-stream",p=g.name||`image_${c}.${Ht(l)}`;d("prompt",r,n,{step:"backend:request",source:"backend",message:"Requesting signed URL"});let{uploadUrl:f,imageKey:v}=await Gt(t,r,p,l,g.size||0,n);d("prompt",r,n,{step:"backend:waiting",source:"backend",message:"Uploading"}),await $t(f,g,l,n),u.push(v)}return{imageUrls:u}}var Be,Oe,Re,C,W,Me,Pt,Ke,se,Ee,It,Ie,Ft,Fe,Dt,De,Ut,zt,Ue,_,Nt,We,Xt,Jt,Qt,Zt,_e=P(()=>{"use strict";Be=require("@smart-cloud/wpsuite-core");ne();te();He();Oe=8,Re=2,C=new Map,W=new Map;typeof window<"u"&&window.addEventListener("beforeunload",()=>{for(let e of C.values())try{e.destroy()}catch{}C.clear(),W.clear()});Me=(0,Be.getWpSuite)();Pt=45e3,Ke=5e3,se=class extends Error{timeoutMs;constructor(t){super(`On-device execution exceeded ${t}ms`),this.name="OnDeviceTimeoutError",this.timeoutMs=t}};Ee=e=>{let t=e.outputLanguage?e.outputLanguage:S(),r={tone:e.tone,format:e.format,length:e.length,outputLanguage:t};return Promise.resolve(r)},It=async(e,t)=>{let r=L(t),n=e.sharedContext??F(),a=e.outputLanguage?e.outputLanguage:S(),o=a,s=!1;N(a)||(s=!0,a="en");let i=Ee({...e,outputLanguage:a});return M(r,t?.modeOverride,!1,"writer",i,async()=>{if(typeof Writer>"u")throw new Error("Writer API not available in this browser.");d("writer",r,t,{step:"on-device:init",source:"on-device",message:"Creating Writer session"});let u=B(t);try{let{model:c,release:g}=await R("writer",{core:i,sharedContext:n},()=>Writer.create({...i,sharedContext:n,monitor(l){l.addEventListener("downloadprogress",p=>{let f=p.loaded;d("writer",r,t,{step:"on-device:download",source:"on-device",progress:f,loaded:f})})}}),l=>l.destroy());d("writer",r,t,{step:"on-device:ready",source:"on-device"});try{d("writer",r,t,{step:"on-device:run",source:"on-device",message:"Generating text"});let l=await c.write(e.prompt,{context:e.context,signal:u.signal});return s?{result:(await _({text:l,sourceLanguage:a,targetLanguage:o},{context:r,signal:u.signal})).result}:{result:l}}finally{try{g()}catch(l){console.error("Error destroying writer:",l)}}}finally{u.dispose()}},Ot({...e,sharedContext:n,outputLanguage:o}),t)},Ie=e=>{let t=e.outputLanguage?e.outputLanguage:S(),r={tone:e.tone,format:e.format,length:e.length,outputLanguage:t};return Promise.resolve(r)},Ft=async(e,t)=>{let r=L(t),n=e.sharedContext??F(),a=e.outputLanguage?e.outputLanguage:S(),o=a,s=!1;N(a)||(s=!0,a="en");let i=Ie({...e,outputLanguage:a});return M(r,t?.modeOverride,!1,"rewriter",i,async()=>{if(typeof Rewriter>"u")throw new Error("Rewriter API not available in this browser.");d("rewriter",r,t,{step:"on-device:init",source:"on-device",message:"Creating Rewriter session"});let u=B(t);try{let{model:c,release:g}=await R("rewriter",{core:i,sharedContext:n},()=>Rewriter.create({...i,sharedContext:n,monitor(l){l.addEventListener("downloadprogress",p=>{let f=p.loaded;d("rewriter",r,t,{step:"on-device:download",source:"on-device",progress:f,loaded:f})})}}),l=>l.destroy());d("rewriter",r,t,{step:"on-device:ready",source:"on-device"});try{d("rewriter",r,t,{step:"on-device:run",source:"on-device",message:"Rewriting text"});let l=await c.rewrite(e.text,{context:e.context,signal:u.signal});return s?{result:(await _({text:l,sourceLanguage:a,targetLanguage:o},{context:r,signal:u.signal})).result}:{result:l}}finally{try{g()}catch(l){console.error("Error destroying rewriter:",l)}}}finally{u.dispose()}},Rt({...e,sharedContext:n,outputLanguage:o}),t)},Fe=()=>Promise.resolve({includeCorrectionTypes:!0,includeCorrectionExplanations:!0}),Dt=async(e,t)=>{let r=L(t),n=await Fe();return M(r,t?.modeOverride,!1,"proofreader",n,async()=>{if(typeof Proofreader>"u")throw new Error("Proofreader API not available in this browser.");d("proofreader",r,t,{step:"on-device:init",source:"on-device",message:"Creating Proofreader session"});let a=B(t);try{let{model:o,release:s}=await R("proofreader",{core:n},()=>Proofreader.create({...n,monitor(i){i.addEventListener("downloadprogress",u=>{let c=u.loaded;d("proofreader",r,t,{step:"on-device:download",source:"on-device",progress:c,loaded:c})})}}),i=>i.destroy());d("proofreader",r,t,{step:"on-device:ready",source:"on-device"});try{return d("proofreader",r,t,{step:"on-device:run",source:"on-device",message:"Proofreading"}),{result:await o.proofread(e.text,{signal:a.signal})}}finally{try{s()}catch(i){console.error("Error destroying proofreader:",i)}}}finally{a.dispose()}},Et(e),t)},De=e=>{let t=e.outputLanguage?e.outputLanguage:S(),r={type:e.type,format:e.format,length:e.length,outputLanguage:t};return Promise.resolve(r)},Ut=async(e,t)=>{let r=L(t),n=e.sharedContext??F(),a=e.outputLanguage?e.outputLanguage:S(),o=a,s=!1;N(a)||(s=!0,a="en");let i=await De({...e,outputLanguage:a});return M(r,t?.modeOverride,!1,"summarizer",i,async()=>{if(typeof Summarizer>"u")throw new Error("Summarizer API not available in this browser.");d("summarizer",r,t,{step:"on-device:init",source:"on-device",message:"Creating Summarizer session"});let u=B(t);try{let{model:c,release:g}=await R("summarizer",{core:i,sharedContext:n},()=>Summarizer.create({...i,sharedContext:n,monitor(l){l.addEventListener("downloadprogress",p=>{let f=p.loaded;d("summarizer",r,t,{step:"on-device:download",source:"on-device",progress:f,loaded:f})})}}),l=>l.destroy());d("summarizer",r,t,{step:"on-device:ready",source:"on-device"});try{d("summarizer",r,t,{step:"on-device:run",source:"on-device",message:"Summarizing"});let l=await c.summarize(e.text,{context:e.context,signal:u.signal});return s?{result:(await _({text:l,sourceLanguage:a,targetLanguage:o},{context:r,signal:u.signal})).result}:{result:l}}finally{try{g()}catch(l){console.error("Error destroying summarizer:",l)}}}finally{u.dispose()}},Bt({...e,sharedContext:n,outputLanguage:o}),t)},zt=async(e,t)=>{let r=L(t);return M(r,t?.modeOverride,t?.silent,"language-detector",void 0,async()=>{if(typeof LanguageDetector>"u")throw new Error("LanguageDetector API not available in this browser.");d("language-detector",r,t,{step:"on-device:init",source:"on-device",message:"Creating LanguageDetector session",silent:t?.silent});let n=B(t,Ke);try{let{model:a,release:o}=await R("language-detector",{},()=>LanguageDetector.create({monitor(s){s.addEventListener("downloadprogress",i=>{let u=i.loaded;d("language-detector",r,t,{step:"on-device:download",source:"on-device",progress:u,loaded:u,silent:t?.silent})})}}),s=>s.destroy());d("language-detector",r,t,{step:"on-device:ready",source:"on-device",silent:t?.silent});try{return d("language-detector",r,t,{step:"on-device:run",source:"on-device",message:"Detecting language",silent:t?.silent}),{result:{candidates:(await a.detect(e.text,{signal:n.signal})).filter(i=>ie.find(u=>u.value===i.detectedLanguage))}}}finally{try{o()}catch(s){console.error("Error destroying language detector:",s)}}}finally{n.dispose()}},Kt(e.text,t),t)},Ue=e=>{let t={sourceLanguage:e.sourceLanguage??"auto",targetLanguage:e.targetLanguage??S()??"en"};return Promise.resolve(t)},_=async(e,t)=>{let r=L(t),n=await Ue({...e});return M(r,t?.modeOverride,t?.silent,"translator",n,async()=>{if(typeof Translator>"u")throw new Error("Translator API not available in this browser.");d("translator",r,t,{step:"on-device:init",source:"on-device",message:"Creating Translator session",silent:t?.silent});let a=B(t,Ke);try{let{model:o,release:s}=await R("translator",{core:n},()=>Translator.create({...n,monitor(i){i.addEventListener("downloadprogress",u=>{let c=u.loaded;d("translator",r,t,{step:"on-device:download",source:"on-device",progress:c,loaded:c,silent:t?.silent})})}}),i=>i.destroy());d("translator",r,t,{step:"on-device:ready",source:"on-device",silent:t?.silent});try{d("translator",r,t,{step:"on-device:run",source:"on-device",message:"Translating",silent:t?.silent});let i=[],u=()=>{if(typeof a.signal.throwIfAborted=="function")a.signal.throwIfAborted();else if(a.signal.aborted)throw a.signal.reason??new DOMException("Aborted","AbortError")};for(let g of e.text.split(`
`))u(),i.push(o.translate(g.trim()));return{result:(await Promise.all(i)).join(`
`)}}finally{try{s()}catch(i){console.error("Error destroying translator:",i)}}}finally{a.dispose()}},Mt(e.text,e.sourceLanguage,e.targetLanguage),t)};Nt=4*1024*1024;We=async e=>{let t=e.outputLanguage?e.outputLanguage:S();return N(t)||(t="en"),{topK:e.topK,temperature:e.temperature,expectedInputs:[{type:"text"},{type:"image"}],expectedOutputs:[{type:"text",languages:[t]}]}},Xt=async(e,t)=>{let r=L(t),n=e.sharedContext??F(),a=e.outputLanguage?e.outputLanguage:S(),o=a,s=!1;N(a)||(s=!0,a="en");let i=await We({...e,outputLanguage:a}),u=await V("prompt",i,t?.modeOverride);return M(r,t?.modeOverride,!1,"prompt",i,async()=>{if(typeof LanguageModel>"u")throw new Error("LanguageModel API not available in this browser.");d("prompt",r,t,{step:"on-device:init",source:"on-device",message:"Creating LanguageModel session"});let c=[];if(typeof e.messages!="string"){for(let f of e.messages)f.role==="system"&&f.content.trim()&&c.push(f.content.trim());n&&n.trim()&&c.push("SHARED CONTEXT: "+n.trim())}let g=c.length>0?c.join(`

`):void 0,l=g?[{role:"system",content:g}]:void 0,p=B(t);try{let{model:f,release:v}=await R("language-model",{core:i,initialPrompts:l},()=>LanguageModel.create({...i,initialPrompts:l,monitor(m){m.addEventListener("downloadprogress",k=>{let D=k.loaded;d("prompt",r,t,{step:"on-device:download",source:"on-device",progress:D,loaded:D})})}}),m=>m.destroy());d("prompt",r,t,{step:"on-device:ready",source:"on-device"});try{d("prompt",r,t,{step:"on-device:run",source:"on-device",message:"Generating text"});let m=await f.prompt(Wt(e),{signal:p.signal,responseConstraint:e.responseConstraint});return s?{result:(await _({text:m,sourceLanguage:a,targetLanguage:o},{context:r,signal:p.signal})).result}:{result:m}}finally{try{v()}catch(m){console.error("Error destroying LanguageModel:",m)}}}finally{p.dispose()}},await xt({...e,sharedContext:n},r,u,t),t)},Jt=async(e,t)=>{let r="frontend",n=e.sharedContext??F(),a="prompt",o=await K(),s={feature:a,mode:"backend-only",onDeviceAvailable:!1,backendAvailable:o.available,backendTransport:o.transport,backendApiName:o.apiName,backendBaseUrl:o.baseUrl,backendReason:o.reason},i=await St({sessionId:e.sessionId,message:e.message,images:e.images,sharedContext:n},s,t);d(a,r,t,{step:"backend:request",source:"backend"});let u=await I(s,r,a,i,t);return d(a,r,t,{step:"done",source:"backend"}),u},Qt=async(e,t)=>{let r=L(t),n=e.sharedContext??F(),a="prompt",o=await K(),s={feature:a,mode:"backend-only",onDeviceAvailable:!1,backendAvailable:o.available,backendTransport:o.transport,backendApiName:o.apiName,backendBaseUrl:o.baseUrl,backendReason:o.reason},i=await Lt({query:e.query,topK:e.topK,sessionId:e.sessionId,sharedContext:n,knowledgeBaseId:e.knowledgeBaseId});d(a,r,t,{step:"backend:request",source:"backend"});let u=await I(s,r,a,i,t);return d(a,r,t,{step:"done",source:"backend"}),u},Zt=async(e,t)=>{let r="frontend",n="prompt",a=await K(),o={feature:n,mode:"backend-only",onDeviceAvailable:!1,backendAvailable:a.available,backendTransport:a.transport,backendApiName:a.apiName,backendBaseUrl:a.baseUrl,backendReason:a.reason},s=await Tt({sessionId:e.sessionId,feedbackMessageId:e.feedbackMessageId,feedbackType:e.feedbackType});d(n,r,t,{step:"backend:request",source:"backend"});let i=await I(o,r,n,s,t);return d(n,r,t,{step:"done",source:"backend"}),i}});var kr={};H(kr,{AiKitChatbotIcon:()=>rt,AiKitDocSearchIcon:()=>nt,AiKitFeatureIcon:()=>tt,BackendError:()=>x,LANGUAGE_OPTIONS:()=>ie,TEXT_DOMAIN:()=>y,checkOnDeviceAvailability:()=>tr,decideCapability:()=>er,detectLanguage:()=>mr,dispatchBackend:()=>nr,getAiKitPlugin:()=>T,getMinChromeVersions:()=>Yt,getPromptOptions:()=>fr,getProofreadOptions:()=>ur,getRewriteOptions:()=>sr,getStore:()=>ce,getStoreDispatch:()=>de,getStoreSelect:()=>U,getSummarizeOptions:()=>lr,getTranslateOptions:()=>gr,getWriteOptions:()=>ar,initializeAiKit:()=>vr,observeStore:()=>pe,prompt:()=>br,proofread:()=>cr,rewrite:()=>ir,sanitizeAiKitConfig:()=>Y,sendChatMessage:()=>yr,sendFeedbackMessage:()=>wr,sendSearchMessage:()=>hr,summarize:()=>dr,translate:()=>pr,waitForAiKitReady:()=>X,write:()=>or});module.exports=Xe(kr);var qe,w,ie,ue,Yt,er,tr,rr,nr,b,ar,or,sr,ir,ur,cr,lr,dr,gr,pr,mr,fr,br,yr,wr,hr,vr,He=P(()=>{qe=require("@smart-cloud/wpsuite-core"),w=require("@wordpress/i18n");J();q();me();q();fe();ee();ie=[{label:(0,w.__)("Arabic",y),value:"ar"},{label:(0,w.__)("Chinese",y),value:"zh"},{label:(0,w.__)("Dutch",y),value:"nl"},{label:(0,w.__)("English",y),value:"en"},{label:(0,w.__)("French",y),value:"fr"},{label:(0,w.__)("German",y),value:"de"},{label:(0,w.__)("Hebrew",y),value:"he"},{label:(0,w.__)("Hindi",y),value:"hi"},{label:(0,w.__)("Hungarian",y),value:"hu"},{label:(0,w.__)("Indonesian",y),value:"id"},{label:(0,w.__)("Italian",y),value:"it"},{label:(0,w.__)("Japanese",y),value:"ja"},{label:(0,w.__)("Korean",y),value:"ko"},{label:(0,w.__)("Norwegian",y),value:"no"},{label:(0,w.__)("Polish",y),value:"pl"},{label:(0,w.__)("Portuguese",y),value:"pt"},{label:(0,w.__)("Russian",y),value:"ru"},{label:(0,w.__)("Spanish",y),value:"es"},{label:(0,w.__)("Swedish",y),value:"sv"},{label:(0,w.__)("Thai",y),value:"th"},{label:(0,w.__)("Turkish",y),value:"tr"},{label:(0,w.__)("Ukrainian",y),value:"uk"}],ue=Promise.resolve().then(()=>(te(),Ce)),Yt=async()=>(await ue).MIN_CHROME_VERSION,er=async(...e)=>(await ue).decideCapability(...e),tr=async(...e)=>(await ue).checkOnDeviceAvailability(...e),rr=Promise.resolve().then(()=>(ne(),Te)),nr=async(...e)=>(await rr).dispatchBackend(...e),b=Promise.resolve().then(()=>(_e(),Ne)),ar=async(...e)=>(await b).getWriteOptions(...e),or=async(...e)=>(await b).write(...e),sr=async(...e)=>(await b).getRewriteOptions(...e),ir=async(...e)=>(await b).rewrite(...e),ur=async(...e)=>(await b).getProofreadOptions(...e),cr=async(...e)=>(await b).proofread(...e),lr=async(...e)=>(await b).getSummarizeOptions(...e),dr=async(...e)=>(await b).summarize(...e),gr=async(...e)=>(await b).getTranslateOptions(...e),pr=async(...e)=>(await b).translate(...e),mr=async(...e)=>(await b).detectLanguage(...e),fr=async(...e)=>(await b).getPromptOptions(...e),br=async(...e)=>(await b).prompt(...e),yr=async(...e)=>(await b).sendChatMessage(...e),wr=async(...e)=>(await b).sendFeedbackMessage(...e),hr=async(...e)=>(await b).sendSearchMessage(...e),vr=(e,t)=>{let r=globalThis.WpSuite,n=T();if(!n)throw console.error("AiKit plugin is not available"),new Error("AiKit plugin is not available");(0,qe.attachDefaultPluginRuntime)(n),n.status=n.status??"initializing";let a=ge();return n.features={store:a,renderFeature:async o=>await e({...o,store:await a}),renderSearchComponent:async o=>{if(!t)throw new Error("renderSearchComponent is not configured");return await t({...o,store:await a})},write:async(...o)=>{let s=await b,i=o[1]||{};return o[1]={context:"frontend",...i},s.write(...o)},rewrite:async(...o)=>{let s=await b,i=o[1]||{};return o[1]={context:"frontend",...i},s.rewrite(...o)},proofread:async(...o)=>{let s=await b,i=o[1]||{};return o[1]={context:"frontend",...i},s.proofread(...o)},summarize:async(...o)=>{let s=await b,i=o[1]||{};return o[1]={context:"frontend",...i},s.summarize(...o)},translate:async(...o)=>{let s=await b,i=o[1]||{};return o[1]={context:"frontend",...i},s.translate(...o)},detectLanguage:async(...o)=>{let s=await b,i=o[1]||{};return o[1]={context:"frontend",...i},s.detectLanguage(...o)},prompt:async(...o)=>{let s=await b,i=o[1]||{};return o[1]={context:"frontend",...i},s.prompt(...o)},sendChatMessage:async(...o)=>(await b).sendChatMessage(...o),sendFeedbackMessage:async(...o)=>(await b).sendFeedbackMessage(...o),sendSearchMessage:async(...o)=>(await b).sendSearchMessage(...o)},a.then(()=>{n.status="available",r?.events?.emit("wpsuite:ai-kit:ready",{key:n.key,version:n.version})}).catch(o=>{n.status="error",console.error("AiKit plugin failed to initialize:",o),r?.events?.emit("wpsuite:ai-kit:error",{key:n.key,error:String(o)})}),n}});He();0&&(module.exports={AiKitChatbotIcon,AiKitDocSearchIcon,AiKitFeatureIcon,BackendError,LANGUAGE_OPTIONS,TEXT_DOMAIN,checkOnDeviceAvailability,decideCapability,detectLanguage,dispatchBackend,getAiKitPlugin,getMinChromeVersions,getPromptOptions,getProofreadOptions,getRewriteOptions,getStore,getStoreDispatch,getStoreSelect,getSummarizeOptions,getTranslateOptions,getWriteOptions,initializeAiKit,observeStore,prompt,proofread,rewrite,sanitizeAiKitConfig,sendChatMessage,sendFeedbackMessage,sendSearchMessage,summarize,translate,waitForAiKitReady,write});
